RewriteEngine On
RewriteBase /

# Исключаем из обработки папку docs и все ее подфайлы
RewriteCond %{REQUEST_URI} ^/docs/
RewriteRule ^ - [L]

# Исключаем из обработки URL, указывающие на файлы с этими расширениями (пополняй список при необходимости)
RewriteCond %{REQUEST_URI} \.(pdf|zip|docx|xlsx|pptx|xls|jpg|jpeg|png|gif|svg|mp4|mp3)$ [NC]
RewriteRule ^ - [L]

# Перенаправляем с /page.html на /page (чистый URL)
RewriteCond %{THE_REQUEST} \s/([^\s]+?)\.html(?:\s|\?) [NC]
RewriteRule ^ %1 [R=301,L]

# Если запрашиваемый путь не является директорией, и файла без расширения нет,
# но существует файл с .html — отдаем его (без изменения адреса в браузере)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^ %{REQUEST_URI}.html [L]

# No-cache CSS/JS (браузер не кэширует)
<FilesMatch "\.(css|js)$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires 0
</FilesMatch>

# Долгий кэш для изображений (экономия трафика)
<FilesMatch "\.(jpg|jpeg|png|gif|svg)$">
    Header set Cache-Control "max-age=31536000, public"
</FilesMatch># Cache bust v1.1
<FilesMatch "\.(css|js)$">
Header set Cache-Control "no-cache"
</FilesMatch>
<FilesMatch "\.(png|jpg|jpeg|gif|svg)$">
Header set Cache-Control "max-age=3600"
</FilesMatch>

# Mobile cache fix v1.0
<FilesMatch "\.(css|js|png|jpg)$">
Header set Cache-Control "no-cache"
</FilesMatch>
